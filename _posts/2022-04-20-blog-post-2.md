---
title: 'Install watershed-workflow on a fresh Ubuntu 20.04.4 LTS'
date: 2022-04-20
permalink: /posts/2022/04/blog-post-2/
tags:
  - watershed-workflow Ubuntu
---


Notes: 
* This tutorial mostly follows [ecoon.github.io/watershed-workflow/build/html/install.html](https://ecoon.github.io/watershed-workflow/build/html/install.html) and [github.com/pinshuai/pinshuai.github.io/blob/master/_posts/2020-06-21-Install-Watershed-Workflow.md](https://github.com/pinshuai/pinshuai.github.io/blob/master/_posts/2020-06-21-Install-Watershed-Workflow.md), **but** install SEACAS following [github.com/gsjaardema/seacas/blob/master/README.md](https://github.com/gsjaardema/seacas/blob/master/README.md).
* It's assumed that ATS has been installed following [github.com/ZhiLiHydro/ZhiLiHydro.github.io/blob/master/_posts/2022-04-20-blog-post-1.md](https://github.com/ZhiLiHydro/ZhiLiHydro.github.io/blob/master/_posts/2022-04-20-blog-post-1.md).
* It has been succefully tested in **WSL on a Win 10 machine**, in **VirtualBox on a Win 10 machine**, and on **an Ubuntu workstation**.

## Install essential package(s):

```
sudo apt install zlib1g-dev
```

## Set up Python environment

```
conda create -n watershed_workflow -c conda-forge -c defaults python=3 ipython ipykernel jupyterlab nb_conda_kernels numpy matplotlib scipy meshpy fiona rasterio shapely cartopy pyepsg descartes pyproj requests sortedcontainers attrs pytest pandas geopandas netcdf4 h5py tqdm libarchive
conda activate watershed_workflow
```
* Check if successfully set up:
```
python -c 'import numpy, matplotlib, scipy, rasterio, fiona, shapely, cartopy, meshpy.triangle; print("SUCCESS")'
```

## Download SEACAS

```
cd
git clone https://github.com/gsjaardema/seacas.git
```

## Install Exodus (a part of SEACAS)

(See [gsjaardema.github.io/seacas-docs/sphinx/html/index.html#](https://gsjaardema.github.io/seacas-docs/sphinx/html/index.html#) for SEACAS and Exodus)

```
cd seacas && export ACCESS=`pwd`
MPI=YES ./install-tpl.sh
mkdir build
cd build
../cmake-exodus ## ../cmake-config if try to install full SEACAS
make && make install
```

* Test if Exodus successfully installed:

```
export PYTHONPATH=${ACCESS}/lib
python -c 'import exodus; print("SUCCESS")'
```

## Download watershed-workflow

```
cd
git clone https://github.com/ecoon/watershed-workflow.git
```

## Install watershed-workflow

```
cd watershed-workflow
python -m pip install -e .
```

* Export PYTHONPATH:

```
cd
vi .bashrc
```

* Append the following line to `.bashrc`:

```
export PYTHONPATH="~/watershed-workflow/bin:~/seacas/lib"
```

* Source `.bashrc`:

```
source .bashrc
```

* Test if watershed-workflow successfully installed:

```
cd watershed-workflow
pytest watershed_workflow/test
```



